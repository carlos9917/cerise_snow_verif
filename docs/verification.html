<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Carlos Peralta">
<meta name="dcterms.date" content="2024-01-07">

<title>Verification for the CRYO data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="verification_files/libs/clipboard/clipboard.min.js"></script>
<script src="verification_files/libs/quarto-html/quarto.js"></script>
<script src="verification_files/libs/quarto-html/popper.min.js"></script>
<script src="verification_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="verification_files/libs/quarto-html/anchor.min.js"></script>
<link href="verification_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="verification_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="verification_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="verification_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="verification_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Verification for the CRYO data</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Carlos Peralta </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 7, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">January 8, 2024</p>
    </div>
  </div>
    
  </div>
  

</header>

<p>Writing here the methodology followed to verify the data snow cover data from CRYO againgst the snow cover data from CARRA</p>
<section id="naive-approach" class="level2">
<h2 class="anchored" data-anchor-id="naive-approach">naive approach</h2>
<p>The data provided in the snow_cryo files consists of points on a 5-10km grid, mainly over Greenland. Since this part is covered by the CARRA west domain only this data will be used for the moment. The files are provided once a day in ascii format</p>
<pre><code>snow_cryo_5-10km_2022100106.dat  snow_cryo_5-10km_2022101706.dat
snow_cryo_5-10km_2022100206.dat  snow_cryo_5-10km_2022101806.dat
snow_cryo_5-10km_2022100306.dat  snow_cryo_5-10km_2022101906.dat
snow_cryo_5-10km_2022100406.dat  snow_cryo_5-10km_2022102006.dat
snow_cryo_5-10km_2022100506.dat  snow_cryo_5-10km_2022102106.dat
snow_cryo_5-10km_2022100606.dat  snow_cryo_5-10km_2022102206.dat
</code></pre>
<p>And contents</p>
<pre><code>20221006  6  77.47196  -105.57903  100.00  1
20221006  6  77.55873  -105.68999  100.00  1
20221006  6  77.64545  -105.80251  100.00  1
20221006  6  77.73211  -105.91662  100.00  1
20221006  6  77.49586  -105.18301  100.00  1
20221006  6  77.66968  -105.40137  100.00  1
...
</code></pre>
<p>where the first two columns are datetime ad hour, followed by lat and lon and the probability of snow. The last column is some sort of quality control flag. The model data is provided as fractio of snow cover (shortName: fscov, grib2 parameter: 260289)</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib <span class="im">as</span> mpl</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.cm <span class="im">as</span> cm</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cartopy.crs <span class="im">as</span> ccrs</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cartopy.feature <span class="im">as</span> cfeature</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> xarray <span class="im">as</span> xr</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>cryo_obs<span class="op">=</span><span class="st">"/media/cap/7fed51bd-a88e-4971-9656-d617655b6312/data/CERISE/CRYO_SW"</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_data_fromtxt(txtFile):</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    lat     <span class="op">=</span> []</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    lon     <span class="op">=</span> []</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    snowFrac <span class="op">=</span> []</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    f <span class="op">=</span> <span class="bu">open</span>(txtFile, <span class="st">'r'</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> f:</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>        line    <span class="op">=</span> line.strip()</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>        columns <span class="op">=</span> line.split()</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>        lat.append(<span class="bu">float</span>(columns[<span class="dv">2</span>]))</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>        lon.append(<span class="bu">float</span>(columns[<span class="dv">3</span>]))</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>        snowFrac.append(<span class="bu">float</span>(columns[<span class="dv">4</span>]))</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    f.close()</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> lat, lon, snowFrac</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>snow_file<span class="op">=</span>os.path.join(cryo_obs,<span class="st">"snow_cryo_5-10km_2022100306.dat"</span>)</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>lats,lons,snow_prob <span class="op">=</span> get_data_fromtxt(snow_file)</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="co">#mycmap = plt.cm.get_cmap('cool') #old style, deprecated</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>mycmap <span class="op">=</span> mpl.colormaps[<span class="st">"cool"</span>]</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>lowerLeftLat  <span class="op">=</span> <span class="dv">60</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>lowerLeftLon  <span class="op">=</span> <span class="op">-</span><span class="dv">120</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>upperRightLat <span class="op">=</span> <span class="dv">90</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>upperRightLon <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>lat_inter <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>lon_inter <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a><span class="co">#fig = plt.figure(figsize=(7.88,6.29), dpi=100)</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">40</span>, <span class="dv">60</span>),dpi<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">111</span>, projection<span class="op">=</span>ccrs.PlateCarree())</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>ax.add_feature(cfeature.BORDERS.with_scale(<span class="st">'10m'</span>), linestyle<span class="op">=</span><span class="st">':'</span>)</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>ax.gridlines(crs<span class="op">=</span>ccrs.PlateCarree(), draw_labels<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>                  linewidth<span class="op">=</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">'gray'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>ax.coastlines()</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>ax.add_feature(cfeature.LAND)</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>ax.add_feature(cfeature.OCEAN)</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>ax.scatter(lons, lats, edgecolor<span class="op">=</span><span class="st">"none"</span>, s<span class="op">=</span><span class="dv">10</span>,c<span class="op">=</span>snow_prob,cmap<span class="op">=</span>mycmap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>&lt;matplotlib.collections.PathCollection at 0x7f6bdeed7850&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="verification_files/figure-html/cell-2-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>Since the data from CARRA is gridded and the observation data is not, they will be put in the same grid using the scripts in the directory <code>scr</code>.</p>
<p>In order to compare both quantities, the information will be used to define a binary quantity defining points with snow or no-snow. Looking at the distribution of two sample dates from observation and forecast data. For the observation, the histogram of snow probability generally looks like this</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./figs/snow_cryo.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">cryo snow probability histogram</figcaption><p></p>
</figure>
</div>
<p>For the forecast, the histogram of fraction of snow cover looks like this <img src="./figs/snow_carra.png" class="img-fluid" alt="carra snow fraction histogram"></p>
<p>Based on these plots, will be selecting snow probabilities over 90 % as “snow” (1.0, otherwise “no snow” (0.0) For the model, the threshold will be set at 80 %.</p>
<section id="putting-the-data-in-the-same-format" class="level3">
<h3 class="anchored" data-anchor-id="putting-the-data-in-the-same-format">Putting the data in the same format</h3>
<p>In order to place the data in the same grid, a grib file from CARRA in a regular lat lon grid will be used as template to place the snow data on the same grid. The points closest to the coordinates of the CARRA grid are chosen, using a nearest neighbour approach. The values are converted to snow or no snow following the thresholds above.</p>
<p>Note that the variable name “fscov” and parameter 260289 will continue to be used in the output grib file, since changing the name of the parameter name in the grib to a dummy “snow_no_snow” variable would imply creating a new variable definition in the grib tables.</p>
</section>
<section id="example-output" class="level3">
<h3 class="anchored" data-anchor-id="example-output">Example output</h3>
<p>Two example files are shown below</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>grib_data<span class="op">=</span><span class="st">"/media/cap/7fed51bd-a88e-4971-9656-d617655b6312/data/CERISE/MODEL_DATA"</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>grib_fcst <span class="op">=</span> os.path.join(grib_data,<span class="st">"snow_cover_202210_ll_grid.grib2"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>grib_fcst <span class="op">=</span> os.path.join(grib_data,<span class="st">"binary_snow_model_201505_ll_grid_600.grib2"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>param_fcst<span class="op">=</span><span class="st">"fscov"</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>fcst <span class="op">=</span> xr.open_dataset(grib_fcst,engine<span class="op">=</span><span class="st">'cfgrib'</span>, backend_kwargs<span class="op">=</span>{<span class="st">'filter_by_keys'</span>:{<span class="st">'shortName'</span>: param_fcst}})</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>fcst[<span class="st">"fscov"</span>][<span class="dv">24</span>,:,:].plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/media/cap/7fed51bd-a88e-4971-9656-d617655b6312/data/sources/conda/mambaforge-pypy3/envs/py311/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'rasterio' loading failed:
libabsl_cord.so.2301.0.0: cannot open shared object file: No such file or directory
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>&lt;matplotlib.collections.QuadMesh at 0x7f6bdd47ccd0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="verification_files/figure-html/cell-3-output-3.png" width="589" height="449"></p>
</div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>grib_obs <span class="op">=</span> os.path.join(grib_data,<span class="st">"binary_snow_cryo_201505_ll_grid_600.grib2"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>param_fcst<span class="op">=</span><span class="st">"fscov"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>obs <span class="op">=</span> xr.open_dataset(grib_obs,engine<span class="op">=</span><span class="st">'cfgrib'</span>, backend_kwargs<span class="op">=</span>{<span class="st">'filter_by_keys'</span>:{<span class="st">'shortName'</span>: param_fcst}})</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>obs[<span class="st">'fscov'</span>][<span class="dv">0</span>,:,:].plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>&lt;matplotlib.collections.QuadMesh at 0x7f6bdd19eb90&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="verification_files/figure-html/cell-4-output-2.png" width="589" height="449"></p>
</div>
</div>
<p>The interpolated data put on the same grid for the snow-cryo files looks like this. For the model, all values were set to 1.0 if snow fraction is &gt;= 0.8, while for the snow observations values were set to 1.0 if probability was equal or more than 90 %.</p>
<p>#‘Fraction_of_snow_cover_surface in binary_snow_cryo_201505_ll_grid_.png’ #‘Fraction_of_snow_cover_surface in binary_snow_model_201505_ll_grid.png’</p>
<p><img src="./figs/Fraction_of_snow_cover_surface%20in%20binary_snow_cryo_201505_ll_grid_.png" class="img-fluid" alt="cryo snow observations"> [cryo snow model](./figs/Fraction_of_snow_cover_surface&nbsp;in&nbsp;binary_snow_model_201505_ll_grid_.png</p>
<p>Another option is to use the gridded files</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>obs_nc  <span class="op">=</span> os.path.join(grib_data,<span class="st">"daily-avhrr-sce-nhl_ease-50_201505111200.nc"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>obs_ease <span class="op">=</span> xr.open_dataset(obs_nc,engine<span class="op">=</span><span class="st">'netcdf4'</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>obs_ease[<span class="st">"prob_snow_o"</span>][<span class="dv">0</span>,:,:].plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>&lt;matplotlib.collections.QuadMesh at 0x7f6bdcd77410&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="verification_files/figure-html/cell-5-output-2.png" width="639" height="464"></p>
</div>
</div>
<p>#Plotting this in another projection #<code>{python} #obs_ease #yc = obs_ease["yc"] #xc = obs_ease["xc"] #fig = plt.figure(figsize=(12,10)) #ax = plt.axes(projection=ccrs.PlateCarree()) #CS = ax.contourf(yc,xc,obs_ease["prob_snow_o"][0,:,:],transform=ccrs.PlateCarree(),cmap="RdBu_r") #ax.gridlines(draw_labels=True, linewidth=1, color='gray', alpha=0.5, linestyle='--') #ax.coastlines(color='black') ##ax.set_title(f'CARRA monthly 2m temperature for {dt}', fontsize=16) #cbar = plt.colorbar(im,fraction=0.05, pad=0.04,orientation="horizontal") #plt.show() #</code></p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>